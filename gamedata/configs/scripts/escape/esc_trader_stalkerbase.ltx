[logic]
active = remark@wait
trade = misc\trade\trade_trader_esc_stalker.ltx
level_spot = trader
on_death = death

[remark@wait]
anim = wait_trade
on_signal = anim_end | smartcover@near_table
;on_game_timer = 20 | smartcover@near_table
meet = no_meet
invulnerable = true
combat_ignore_cond = true
combat_ignore_keep_when_attacked = true

[smartcover@near_table]
cover_name = esc_smart_cover_trader_1
loophole_name = lead_stand_look_at_table
cover_state = idle_target
combat_ignore_cond = true
combat_ignore_keep_when_attacked = true
invulnerable = true
out_restr = esc_space_restrictor_in_restr_1
on_timer = 13330 | smartcover@near_table2
def_state_standing = wait_trade
def_state_moving = walk_noweap
def_state_moving1 = walk_noweap
on_info = {=actor_in_zone(esc_trader_tradezone)} walker@all_to_trade
meet = meet

[smartcover@near_table2]
cover_name = esc_smart_cover_trader_1
loophole_name = lead_stand_look_at_table
cover_state = lookout_target
combat_ignore_cond = true
combat_ignore_keep_when_attacked = true
invulnerable = true
out_restr = esc_space_restrictor_in_restr_1
on_timer = 15000 | smartcover@near_table3
def_state_standing = wait_trade
def_state_moving = walk_noweap
def_state_moving1 = walk_noweap
on_info = {=actor_in_zone(esc_trader_tradezone)} walker@all_to_trade
meet = meet

[smartcover@near_table3]
cover_name = esc_smart_cover_trader_1
loophole_name = lead_stand_look_at_table
cover_state = fire_no_lookout_target
combat_ignore_cond = true
combat_ignore_keep_when_attacked = true
invulnerable = true
out_restr = esc_space_restrictor_in_restr_1
on_timer = 4500 | smartcover@near_table4
def_state_standing = wait_trade
def_state_moving = walk_noweap
def_state_moving1 = walk_noweap
on_info = {=actor_in_zone(esc_trader_tradezone)} walker@all_to_trade
meet = meet

[smartcover@near_table4]
cover_name = esc_smart_cover_trader_1
loophole_name = lead_stand_look_at_table
cover_state = fire_target
combat_ignore_cond = true
combat_ignore_keep_when_attacked = true
invulnerable = true
out_restr = esc_space_restrictor_in_restr_1
on_timer = 6500 | smartcover@near_table
def_state_standing = wait_trade
def_state_moving = walk_noweap
def_state_moving1 = walk_noweap
on_info = {=actor_in_zone(esc_trader_tradezone)} walker@all_to_trade
meet = meet

[walker@all_to_trade]
path_walk = esc_trader_stalkerbase_walk
path_look = esc_trader_stalkerbase_look
on_signal = turn_end | smartcover@trade
combat_ignore_cond = true
combat_ignore_keep_when_attacked = true
invulnerable = true
out_restr = esc_space_restrictor_in_restr_1
def_state_standing = wait_trade
def_state_moving = walk_noweap
def_state_moving1 = walk_noweap
meet = meet

[smartcover@trade]
cover_name = esc_smart_cover_trader_1
loophole_name = lead_stand_look_at_table
cover_state = idle_target
combat_ignore_cond = true
combat_ignore_keep_when_attacked = true
invulnerable = true
out_restr = esc_space_restrictor_in_restr_1
def_state_standing = wait_trade
def_state_moving = walk_noweap
def_state_moving1 = walk_noweap
meet = meet
on_info = {!actor_in_zone(esc_trader_tradezone)} smartcover@near_table

[death]
on_info = %+esc_stalker_trader_dead%

[meet]
meet_state		= 3|nil@nil
meet_state_wpn	= 3|nil@nil
victim			= 3|actor
victim_wpn		= 3|actor
precond 		= visibility
sound_start 	= esc_stalker_trader_meet
sound_stop 		= esc_stalker_trader_meet_bye
use				= true
use_wpn				= true
abuse			= false
quest_npc = true
